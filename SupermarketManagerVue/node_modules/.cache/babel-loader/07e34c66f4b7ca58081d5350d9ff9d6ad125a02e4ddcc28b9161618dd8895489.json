{"ast":null,"code":"import { listByQo } from \"@/api/personnel_management/department/deptApi\";\nimport { popup } from \"@/assets/js/common\";\nimport { queryInformation } from \"@/api/personal/personApi\";\nimport { update } from \"@/api/personnel_management/employee/empApi\";\nimport { loginEmp } from \"@/assets/js/auth\";\nexport default {\n  data() {\n    return {\n      BaseApi: this.$store.state.BaseApi,\n      loginEid: loginEmp().id,\n      informationForm: {},\n      imageUrl: \"\",\n      options: [],\n      rules: {\n        username: [{\n          required: true,\n          message: \"手机号不能为空\",\n          trigger: \"blur\"\n        }],\n        nickName: [{\n          required: true,\n          message: \"姓名不能为空\",\n          trigger: \"blur\"\n        }],\n        idCard: [{\n          required: true,\n          message: \"身份证号不能为空\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  methods: {\n    deptAll() {\n      listByQo({}).then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.options = res.data;\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    init() {\n      queryInformation().then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.informationForm = {\n            ...res.data\n          };\n          this.imageUrl = this.informationForm.headImg;\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    submitInformationForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          update(this.informationForm).then(res => {\n            res = res.data;\n            if (res.code == 200) {\n              popup(\"更新成功\");\n            } else {\n              popup(res.msg, \"error\");\n            }\n            this.init();\n          });\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n      this.init();\n    },\n    /*上传头像*/\n    handleAvatarSuccess(res) {\n      this.informationForm.headImg = res.url;\n      this.imageUrl = res.url;\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === \"image/jpeg\" || file.type === \"image/png\";\n      const isLt2M = file.size / 1024 / 1024 < 3;\n      if (!isJPG) {\n        this.$message.error(\"上传头像图片只能是 JPG或PNG 格式!\");\n      }\n      if (!isLt2M) {\n        this.$message.error(\"上传头像图片大小不能超过 3MB!\");\n      }\n      return isJPG && isLt2M;\n    }\n  },\n  mounted() {\n    this.imageUrl = \"\";\n    this.deptAll();\n    this.init();\n  }\n};","map":{"version":3,"names":["listByQo","popup","queryInformation","update","loginEmp","data","BaseApi","$store","state","loginEid","id","informationForm","imageUrl","options","rules","username","required","message","trigger","nickName","idCard","methods","deptAll","then","res","code","msg","init","headImg","submitInformationForm","formName","$refs","validate","valid","resetForm","resetFields","handleAvatarSuccess","url","beforeAvatarUpload","file","isJPG","type","isLt2M","size","$message","error","mounted"],"sources":["src/views/personal/Information.vue"],"sourcesContent":["<template>\n    <div id=\"information\">\n        <el-breadcrumb separator=\"/\">\n            <el-breadcrumb-item>首页</el-breadcrumb-item>\n            <el-breadcrumb-item>个人中心 </el-breadcrumb-item>\n            <el-breadcrumb-item>个人资料</el-breadcrumb-item> </el-breadcrumb\n        ><br />\n\n        <i class=\"iconfont icon-r-paper\" style=\"font-size: 32px\">\n            <b style=\"font-size: 28px\">完善个人资料</b></i\n        >\n        <el-form\n            size=\"mini\"\n            :model=\"informationForm\"\n            :rules=\"rules\"\n            ref=\"informationForm\"\n            label-width=\"100px\"\n            class=\"demo-ruleForm\"\n        >\n            <el-row>\n                <el-col :span=\"12\">\n                    <el-form-item style=\"width: 40%\">\n                        <el-upload\n                            v-if=\"loginEid != 1\"\n                            class=\"avatar-uploader\"\n                            action=\"http://localhost:9291/personnel_management/employee/uploadImg\"\n                            :show-file-list=\"false\"\n                            :on-success=\"handleAvatarSuccess\"\n                            :before-upload=\"beforeAvatarUpload\"\n                        >\n                            <img\n                                v-if=\"imageUrl\"\n                                :src=\"BaseApi + imageUrl\"\n                                class=\"avatar\"\n                            />\n                            <i\n                                v-else\n                                class=\"el-icon-plus avatar-uploader-icon\"\n                            ></i>\n                        </el-upload>\n                        <el-upload\n                            disabled\n                            v-if=\"loginEid == 1\"\n                            class=\"avatar-uploader\"\n                            action=\"http://localhost:9291/personnel_management/employee/uploadImg\"\n                            :show-file-list=\"false\"\n                            :on-success=\"handleAvatarSuccess\"\n                            :before-upload=\"beforeAvatarUpload\"\n                        >\n                            <img\n                                v-if=\"imageUrl\"\n                                :src=\"BaseApi + imageUrl\"\n                                class=\"avatar\"\n                            />\n                            <i\n                                v-else\n                                class=\"el-icon-plus avatar-uploader-icon\"\n                            ></i>\n                        </el-upload>\n                    </el-form-item>\n                </el-col>\n            </el-row>\n            <el-row>\n                <el-col :span=\"12\">\n                    <el-form-item\n                        style=\"width: 40%\"\n                        label=\"电话号码：\"\n                        prop=\"username\"\n                    >\n                        <el-input\n                            v-if=\"loginEid == 1\"\n                            readonly\n                            max=\"11\"\n                            v-model=\"informationForm.username\"\n                        ></el-input>\n                        <el-input\n                            v-if=\"loginEid != 1\"\n                            max=\"11\"\n                            v-model=\"informationForm.username\"\n                        ></el-input>\n                    </el-form-item>\n                </el-col>\n                <el-col :span=\"12\">\n                    <el-form-item\n                        style=\"width: 40%\"\n                        label=\"姓名：\"\n                        prop=\"nickName\"\n                    >\n                        <el-input\n                            v-if=\"loginEid != 1\"\n                            v-model=\"informationForm.nickName\"\n                        ></el-input>\n                        <el-input\n                            v-if=\"loginEid == 1\"\n                            readonly\n                            v-model=\"informationForm.nickName\"\n                        ></el-input>\n                    </el-form-item>\n                </el-col>\n            </el-row>\n            <el-row>\n                <el-col :span=\"12\">\n                    <el-form-item\n                        style=\"width: 40%\"\n                        label=\"身份证号：\"\n                        prop=\"idCard\"\n                    >\n                        <el-input\n                            v-if=\"loginEid != 1\"\n                            v-model=\"informationForm.idCard\"\n                        ></el-input>\n                        <el-input\n                            v-if=\"loginEid == 1\"\n                            disabled\n                            v-model=\"informationForm.idCard\"\n                        ></el-input>\n                    </el-form-item>\n                </el-col>\n                <el-col :span=\"12\">\n                    <el-form-item style=\"width: 40%\" label=\"年龄：\">\n                        <el-input\n                            v-if=\"loginEid != 1\"\n                            type=\"number\"\n                            min=\"18\"\n                            max=\"70\"\n                            v-model=\"informationForm.age\"\n                        ></el-input>\n                        <el-input\n                            v-if=\"loginEid == 1\"\n                            readonly\n                            type=\"number\"\n                            min=\"18\"\n                            max=\"70\"\n                            v-model=\"informationForm.age\"\n                        ></el-input>\n                    </el-form-item>\n                </el-col>\n            </el-row>\n            <el-row>\n                <el-col :span=\"12\">\n                    <el-form-item\n                        v-if=\"loginEid != 1\"\n                        style=\"width: 40%\"\n                        label=\"所属部门：\"\n                    >\n                        <el-select\n                            disabled\n                            v-if=\"loginEid != 1\"\n                            style=\"width: 200px\"\n                            v-model=\"informationForm.deptId\"\n                            placeholder=\"请选择部门\"\n                            filterable\n                            @change=\"$forceUpdate()\"\n                            clearable\n                        >\n                            <el-option\n                                v-for=\"item in options\"\n                                :key=\"item.id\"\n                                :label=\"item.name\"\n                                :value=\"item.id\"\n                            >\n                            </el-option>\n                        </el-select>\n                    </el-form-item>\n                </el-col>\n                <el-col :span=\"12\">\n                    <el-form-item style=\"width: 40%\" label=\"住址：\">\n                        <el-input\n                            v-if=\"loginEid != 1\"\n                            type=\"text\"\n                            v-model=\"informationForm.address\"\n                        ></el-input>\n                        <el-input\n                            v-if=\"loginEid == 1\"\n                            readonly\n                            type=\"text\"\n                            v-model=\"informationForm.address\"\n                        ></el-input>\n                    </el-form-item>\n                </el-col>\n            </el-row>\n            <el-row>\n                <el-col :span=\"12\">\n                    <el-form-item style=\"width: 40%\" label=\"备注：\">\n                        <el-input\n                            v-if=\"loginEid != 1\"\n                            type=\"textarea\"\n                            cols=\"50\"\n                            rows=\"3\"\n                            v-model=\"informationForm.info\"\n                        ></el-input>\n                        <el-input\n                            v-if=\"loginEid == 1\"\n                            readonly\n                            type=\"textarea\"\n                            cols=\"50\"\n                            rows=\"3\"\n                            v-model=\"informationForm.info\"\n                        ></el-input>\n                    </el-form-item>\n                </el-col>\n                <el-col :span=\"12\">\n                    <el-form-item style=\"width: 40%\" label=\"性别：\">\n                        <el-select\n                            v-if=\"loginEid != 1\"\n                            style=\"width: 200px\"\n                            v-model=\"informationForm.sex\"\n                            @change=\"$forceUpdate()\"\n                            placeholder=\"请选择性别\"\n                            clearable\n                        >\n                            <el-option label=\"女\" value=\"0\"></el-option>\n                            <el-option label=\"男\" value=\"1\"></el-option>\n                        </el-select>\n                        <el-select\n                            v-if=\"loginEid == 1\"\n                            disabled\n                            style=\"width: 200px\"\n                            v-model=\"informationForm.sex\"\n                            @change=\"$forceUpdate()\"\n                            placeholder=\"请选择性别\"\n                            clearable\n                        >\n                            <el-option label=\"女\" value=\"0\"></el-option>\n                            <el-option label=\"男\" value=\"1\"></el-option>\n                        </el-select>\n                    </el-form-item>\n                </el-col>\n            </el-row>\n            <el-form-item style=\"width: 75%\">\n                <el-button\n                    v-if=\"loginEid != 1\"\n                    type=\"primary\"\n                    @click=\"submitInformationForm('informationForm')\"\n                    >提交</el-button\n                >\n                <el-button\n                    v-if=\"loginEid != 1\"\n                    @click=\"resetForm('informationForm')\"\n                    >重置</el-button\n                >\n            </el-form-item>\n        </el-form>\n    </div>\n</template>\n<script>\nimport { listByQo } from \"@/api/personnel_management/department/deptApi\";\nimport { popup } from \"@/assets/js/common\";\nimport { queryInformation } from \"@/api/personal/personApi\";\nimport { update } from \"@/api/personnel_management/employee/empApi\";\nimport { loginEmp } from \"@/assets/js/auth\";\n\nexport default {\n    data() {\n        return {\n            BaseApi: this.$store.state.BaseApi,\n            loginEid: loginEmp().id,\n            informationForm: {},\n            imageUrl: \"\",\n            options: [],\n            rules: {\n                username: [\n                    {\n                        required: true,\n                        message: \"手机号不能为空\",\n                        trigger: \"blur\",\n                    },\n                ],\n                nickName: [\n                    {\n                        required: true,\n                        message: \"姓名不能为空\",\n                        trigger: \"blur\",\n                    },\n                ],\n                idCard: [\n                    {\n                        required: true,\n                        message: \"身份证号不能为空\",\n                        trigger: \"blur\",\n                    },\n                ],\n            },\n        };\n    },\n    methods: {\n        deptAll() {\n            listByQo({}).then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.options = res.data;\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        init() {\n            queryInformation().then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.informationForm = { ...res.data };\n                    this.imageUrl = this.informationForm.headImg;\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        submitInformationForm(formName) {\n            this.$refs[formName].validate((valid) => {\n                if (valid) {\n                    update(this.informationForm).then((res) => {\n                        res = res.data;\n                        if (res.code == 200) {\n                            popup(\"更新成功\");\n                        } else {\n                            popup(res.msg, \"error\");\n                        }\n                        this.init();\n                    });\n                }\n            });\n        },\n        resetForm(formName) {\n            this.$refs[formName].resetFields();\n            this.init();\n        },\n        /*上传头像*/\n        handleAvatarSuccess(res) {\n            this.informationForm.headImg = res.url;\n            this.imageUrl = res.url;\n        },\n        beforeAvatarUpload(file) {\n            const isJPG =\n                file.type === \"image/jpeg\" || file.type === \"image/png\";\n            const isLt2M = file.size / 1024 / 1024 < 3;\n            if (!isJPG) {\n                this.$message.error(\"上传头像图片只能是 JPG或PNG 格式!\");\n            }\n            if (!isLt2M) {\n                this.$message.error(\"上传头像图片大小不能超过 3MB!\");\n            }\n            return isJPG && isLt2M;\n        },\n    },\n    mounted() {\n        this.imageUrl = \"\";\n        this.deptAll();\n        this.init();\n    },\n};\n</script>\n"],"mappings":"AAsPA,SAAAA,QAAA;AACA,SAAAC,KAAA;AACA,SAAAC,gBAAA;AACA,SAAAC,MAAA;AACA,SAAAC,QAAA;AAEA;EACAC,KAAA;IACA;MACAC,OAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,OAAA;MACAG,QAAA,EAAAL,QAAA,GAAAM,EAAA;MACAC,eAAA;MACAC,QAAA;MACAC,OAAA;MACAC,KAAA;QACAC,QAAA,GACA;UACAC,QAAA;UACAC,OAAA;UACAC,OAAA;QACA,EACA;QACAC,QAAA,GACA;UACAH,QAAA;UACAC,OAAA;UACAC,OAAA;QACA,EACA;QACAE,MAAA,GACA;UACAJ,QAAA;UACAC,OAAA;UACAC,OAAA;QACA;MAEA;IACA;EACA;EACAG,OAAA;IACAC,QAAA;MACAtB,QAAA,KAAAuB,IAAA,CAAAC,GAAA;QACAA,GAAA,GAAAA,GAAA,CAAAnB,IAAA;QACA,IAAAmB,GAAA,CAAAC,IAAA;UACA,KAAAZ,OAAA,GAAAW,GAAA,CAAAnB,IAAA;QACA;UACAJ,KAAA,CAAAuB,GAAA,CAAAE,GAAA;QACA;MACA;IACA;IACAC,KAAA;MACAzB,gBAAA,GAAAqB,IAAA,CAAAC,GAAA;QACAA,GAAA,GAAAA,GAAA,CAAAnB,IAAA;QACA,IAAAmB,GAAA,CAAAC,IAAA;UACA,KAAAd,eAAA;YAAA,GAAAa,GAAA,CAAAnB;UAAA;UACA,KAAAO,QAAA,QAAAD,eAAA,CAAAiB,OAAA;QACA;UACA3B,KAAA,CAAAuB,GAAA,CAAAE,GAAA;QACA;MACA;IACA;IACAG,sBAAAC,QAAA;MACA,KAAAC,KAAA,CAAAD,QAAA,EAAAE,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA9B,MAAA,MAAAQ,eAAA,EAAAY,IAAA,CAAAC,GAAA;YACAA,GAAA,GAAAA,GAAA,CAAAnB,IAAA;YACA,IAAAmB,GAAA,CAAAC,IAAA;cACAxB,KAAA;YACA;cACAA,KAAA,CAAAuB,GAAA,CAAAE,GAAA;YACA;YACA,KAAAC,IAAA;UACA;QACA;MACA;IACA;IACAO,UAAAJ,QAAA;MACA,KAAAC,KAAA,CAAAD,QAAA,EAAAK,WAAA;MACA,KAAAR,IAAA;IACA;IACA;IACAS,oBAAAZ,GAAA;MACA,KAAAb,eAAA,CAAAiB,OAAA,GAAAJ,GAAA,CAAAa,GAAA;MACA,KAAAzB,QAAA,GAAAY,GAAA,CAAAa,GAAA;IACA;IACAC,mBAAAC,IAAA;MACA,MAAAC,KAAA,GACAD,IAAA,CAAAE,IAAA,qBAAAF,IAAA,CAAAE,IAAA;MACA,MAAAC,MAAA,GAAAH,IAAA,CAAAI,IAAA;MACA,KAAAH,KAAA;QACA,KAAAI,QAAA,CAAAC,KAAA;MACA;MACA,KAAAH,MAAA;QACA,KAAAE,QAAA,CAAAC,KAAA;MACA;MACA,OAAAL,KAAA,IAAAE,MAAA;IACA;EACA;EACAI,QAAA;IACA,KAAAlC,QAAA;IACA,KAAAU,OAAA;IACA,KAAAK,IAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}