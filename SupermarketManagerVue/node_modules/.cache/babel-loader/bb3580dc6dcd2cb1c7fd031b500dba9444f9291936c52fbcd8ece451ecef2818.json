{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.unshift.js\";\nimport { popup } from \"@/assets/js/common\";\nimport { getCn, getOptionSaleRecordsGoods, saveSaleRecords } from \"@/api/sale_management/saleRecordsApi\";\nimport { queryGoodsById } from \"@/api/goods_management/goods/goodsApi\";\nimport { queryMemberByPhone } from \"@/api/member_management/member/memberApi\";\nimport { queryMemberByGoodsId, queryOptionsMember, queryOptionsMemberPhone, queryOptionsPointProducts, queryPointProductByGoodsId, queryPointProductBymemberId, saveExchangePointProductRecords } from \"@/api/sale_management/exchange_point_products/exchangePointProductsApi\";\nexport default {\n  data() {\n    return {\n      confirmVisiable: false,\n      newVisable: false,\n      addGoodsVisable: false,\n      paymentCodeVisable: false,\n      goodsNum_max: \"\",\n      totalMoney: \"\",\n      options_saleRecordsAddGoods: [],\n      detailSaleRecords: {},\n      newForm: {\n        cn: \"\",\n        sellway: \"1\",\n        info: \"\",\n        sellTotal: \"\",\n        sellTotalmoney: \"\",\n        type: \"0\",\n        detailSaleRecords: []\n      },\n      pointProductsForm: {\n        memberId: \"\",\n        goodsId: \"\",\n        coverUrl: \"\",\n        integral: \"\"\n      },\n      options_members: [],\n      options_pointProducts: [],\n      pointProductsVisable: false,\n      rules: {\n        sellway: [{\n          required: true,\n          message: \"支付方式未选择\",\n          trigger: \"blur\"\n        }],\n        type: [{\n          required: true,\n          message: \"顾客类型未选择\",\n          trigger: \"blur\"\n        }],\n        memberPhone: [{\n          required: true,\n          message: \"会员电话号码未填写\",\n          trigger: \"blur\"\n        }],\n        goodsId: [{\n          required: true,\n          message: \"商品不能为空\",\n          trigger: \"blur\"\n        }],\n        memberId: [{\n          required: true,\n          message: \"会员编号不能为空\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  methods: {\n    confirmPointProducts(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          queryPointProductByGoodsId({\n            goodsId: this.pointProductsForm.goodsId\n          }).then(res => {\n            res = res.data;\n            if (res.code == 200) {\n              if (!res.data) {\n                this.pointProductsForm = {\n                  memberId: this.pointProductsForm.memberId,\n                  goodsId: this.pointProductsForm.goodsId,\n                  coverUrl: \"\",\n                  integral: \"\"\n                };\n                return;\n              }\n              this.pointProductsForm.integral = res.data.integral;\n              this.pointProductsForm.coverUrl = res.data.coverUrl;\n            } else {\n              popup(res.msg, \"error\");\n            }\n          });\n          this.confirmVisiable = true;\n        }\n      });\n    },\n    closeConfirmPointProducts() {\n      this.confirmVisiable = false;\n      this.pointProductsVisable = false;\n      this.pointProductsForm = {\n        memberId: \"\",\n        goodsId: \"\",\n        coverUrl: \"\",\n        integral: \"\"\n      };\n    },\n    queryPointProductByMemberId() {\n      queryPointProductBymemberId({\n        memberId: this.pointProductsForm.memberId\n      }).then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.options_pointProducts = res.data;\n          if (!this.options_pointProducts.length) {\n            popup(\"该会员积分数无法兑换任何商品\", \"warning\");\n            this.pointProductsForm.goodsId = \"\";\n            return;\n          }\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    queryPointProductByGoodsId() {\n      queryMemberByGoodsId({\n        goodsId: this.pointProductsForm.goodsId\n      }).then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.options_members = res.data;\n          if (!this.options_members.length) {\n            popup(\"该商品没有会员符合条件进行兑换\", \"warning\");\n            this.pointProductsForm.memberId = \"\";\n            return;\n          }\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    queryOptionsPointProducts() {\n      queryOptionsPointProducts().then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.options_pointProducts = res.data;\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    queryOptionsMember() {\n      queryOptionsMember().then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.options_members = res.data;\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    submitPointProductsForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          saveExchangePointProductRecords(this.pointProductsForm).then(res => {\n            res = res.data;\n            if (res.code == 200) {\n              popup(\"兑换成功\");\n              this.pointProductsForm = {};\n              this.pointProductsVisable = false;\n            } else {\n              popup(res.msg, \"error\");\n            }\n          });\n        }\n      });\n    },\n    closePointProductsForm() {\n      this.confirmVisiable = false;\n    },\n    moreFuns() {\n      popup(\"正在研发...\", \"warning\");\n    },\n    queryMemberByPhone(phone) {\n      queryMemberByPhone({\n        phone: phone\n      }).then(res => {\n        res = res.data;\n        if (res.code != 200) {\n          popup(res.msg, \"error\");\n          this.newForm.memberPhone = \"\";\n        }\n      });\n    },\n    saleRecordsBtn() {\n      this.$router.push(\"/sale_management/sale_records/list\");\n    },\n    exchangePointProductsRecordsBtn() {\n      this.$router.push(\"/sale_management/exchange_point_products_records/list\");\n    },\n    submitNewForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          if (this.newForm.detailSaleRecords.length <= 0) {\n            popup(\"还没选择出售的商品\", \"error\");\n            return;\n          }\n          saveSaleRecords(this.newForm).then(res => {\n            res = res.data;\n            if (res.code == 200) {\n              this.newForm = {\n                ...res.data\n              };\n              console.log(this.newForm);\n              popup(\"支付成功\");\n              this.paymentCodeVisable = false;\n            } else {\n              popup(\"系统正忙,支付失败\", \"error\");\n            }\n          });\n        }\n      });\n    },\n    closeNewForm(formName) {\n      this.$refs[formName].resetFields();\n      this.newForm = {\n        cn: \"\",\n        sellway: \"1\",\n        info: \"\",\n        sellTotal: \"\",\n        sellTotalmoney: \"\",\n        type: \"0\",\n        detailSaleRecords: []\n      }, this.newVisable = false;\n    },\n    removedetailRecords(row) {\n      this.$confirm(\"确定删除这条记录？\", \"警示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.newForm.sellTotal = parseInt(this.newForm.sellTotal) - row.goodsNum;\n        this.totalMoney = (parseFloat(this.totalMoney) - parseFloat(parseInt(row.goodsNum) * parseFloat(row.goodsPrice))).toFixed(2);\n        if (this.newForm.type == \"1\") {\n          this.newForm.sellTotalmoney = parseFloat(this.totalMoney) * 0.9.toFixed(2);\n        } else {\n          this.newForm.sellTotalmoney = parseFloat(this.totalMoney).toFixed(2);\n        }\n        for (var i in this.newForm.detailSaleRecords) {\n          if (this.newForm.detailSaleRecords[i].goodsId == row.goodsId) {\n            this.newForm.detailSaleRecords.splice(i, 1);\n            return;\n          }\n        }\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消操作\"\n        });\n      });\n    },\n    addGoodsNum(row) {\n      queryGoodsById({\n        id: row.goodsId\n      }).then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          if (row.goodsNum >= res.data.residueNum) {\n            popup(\"货架商品数量没这么多，请联系仓库管理者\", \"warning\");\n            return;\n          } else {\n            row.goodsNum = parseInt(row.goodsNum) + 1;\n            this.newForm.sellTotal = parseInt(this.newForm.sellTotal) + 1;\n            this.totalMoney = (parseFloat(this.totalMoney) + parseFloat(row.goodsPrice)).toFixed(2);\n            if (this.newForm.type == \"1\") {\n              this.newForm.sellTotalmoney = parseFloat(this.totalMoney) * 0.9.toFixed(2);\n            } else {\n              this.newForm.sellTotalmoney = parseFloat(this.totalMoney).toFixed(2);\n            }\n          }\n        } else {\n          popup(res.msg, \"error\");\n          return;\n        }\n      });\n    },\n    redueGoodsNum(row) {\n      if (parseInt(row.goodsNum) == 1) {\n        popup(\"已是最小数量\", \"error\");\n        return;\n      }\n      row.goodsNum = parseInt(row.goodsNum) - 1;\n      this.newForm.sellTotal = parseInt(this.newForm.sellTotal) - 1;\n      this.totalMoney = (parseFloat(this.totalMoney) - parseFloat(row.goodsPrice)).toFixed(2);\n      if (this.newForm.type == \"1\") {\n        this.newForm.sellTotalmoney = parseFloat(this.totalMoney) * 0.9.toFixed(2);\n      } else {\n        this.newForm.sellTotalmoney = parseFloat(this.totalMoney).toFixed(2);\n      }\n    },\n    initOptionSaleRecordsAddGoodsAll() {\n      getOptionSaleRecordsGoods().then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.options_saleRecordsAddGoods = res.data;\n          if (this.options_saleRecordsAddGoods.length > 0) {\n            this.addGoodsVisable = true;\n          } else {\n            popup(\"目前没有可售卖的商品\", \"warning\");\n          }\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    addGoodsBtn() {\n      this.detailSaleRecords = {};\n      this.goodsNum_max = \"\";\n      this.initOptionSaleRecordsAddGoodsAll();\n    },\n    addDetailSaleRecords() {\n      if (!this.detailSaleRecords.goodsNum) {\n        popup(\"数量不能为空\", \"warning\");\n        return;\n      }\n      this.newForm.sellTotal = Number.parseInt(this.newForm.sellTotal ? this.newForm.sellTotal : 0) + Number.parseInt(this.detailSaleRecords.goodsNum);\n      this.totalMoney = (this.totalMoney ? parseFloat(this.totalMoney) : 0) + parseInt(this.detailSaleRecords.goodsNum) * parseFloat(this.detailSaleRecords.goodsPrice).toFixed(2);\n      if (this.totalMoney) {\n        if (this.newForm.type == \"1\") {\n          this.newForm.sellTotalmoney = this.totalMoney * 0.9;\n        } else {\n          this.newForm.sellTotalmoney = this.totalMoney;\n        }\n      }\n      if (this.newForm.detailSaleRecords.length == 0) {\n        this.newForm.detailSaleRecords.unshift(this.detailSaleRecords);\n      } else {\n        for (var item of this.newForm.detailSaleRecords) {\n          if (item.goodsId == this.detailSaleRecords.goodsId) {\n            item.goodsNum = Number.parseInt(item.goodsNum) + Number.parseInt(this.detailSaleRecords.goodsNum);\n            this.addGoodsVisable = false;\n            return;\n          }\n        }\n        this.newForm.detailSaleRecords.unshift(this.detailSaleRecords);\n      }\n      this.addGoodsVisable = false;\n    },\n    saleBtn() {\n      getCn().then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.newForm.cn = res.data;\n          this.newVisable = true;\n        } else {\n          popup(res.msg, \"error\");\n        }\n      });\n    },\n    selectedAddGoods() {\n      queryGoodsById({\n        id: this.detailSaleRecords.goodsId\n      }).then(res => {\n        res = res.data;\n        if (res.code == 200) {\n          this.detailSaleRecords.goodsPrice = res.data.purchashPrice;\n          this.detailSaleRecords.goodsName = res.data.name;\n          this.goodsNum_max = res.data.residueNum;\n        }\n      });\n    },\n    paymentCode(sellway) {\n      if (this.newForm.detailSaleRecords.length <= 0) {\n        popup(\"还没选择出售的商品\", \"error\");\n        return;\n      }\n      if (sellway != \"2\") {\n        this.paymentCodeVisable = true;\n      }\n    },\n    exchangePointProductBtn() {\n      this.queryOptionsMember();\n      this.queryOptionsPointProducts();\n      this.pointProductsVisable = true;\n    }\n  },\n  mounted() {}\n};","map":{"version":3,"names":["popup","getCn","getOptionSaleRecordsGoods","saveSaleRecords","queryGoodsById","queryMemberByPhone","queryMemberByGoodsId","queryOptionsMember","queryOptionsMemberPhone","queryOptionsPointProducts","queryPointProductByGoodsId","queryPointProductBymemberId","saveExchangePointProductRecords","data","confirmVisiable","newVisable","addGoodsVisable","paymentCodeVisable","goodsNum_max","totalMoney","options_saleRecordsAddGoods","detailSaleRecords","newForm","cn","sellway","info","sellTotal","sellTotalmoney","type","pointProductsForm","memberId","goodsId","coverUrl","integral","options_members","options_pointProducts","pointProductsVisable","rules","required","message","trigger","memberPhone","methods","confirmPointProducts","formName","$refs","validate","valid","then","res","code","msg","closeConfirmPointProducts","queryPointProductByMemberId","length","submitPointProductsForm","closePointProductsForm","moreFuns","phone","saleRecordsBtn","$router","push","exchangePointProductsRecordsBtn","submitNewForm","console","log","closeNewForm","resetFields","removedetailRecords","row","$confirm","confirmButtonText","cancelButtonText","parseInt","goodsNum","parseFloat","goodsPrice","toFixed","i","splice","catch","$message","addGoodsNum","id","residueNum","redueGoodsNum","initOptionSaleRecordsAddGoodsAll","addGoodsBtn","addDetailSaleRecords","Number","unshift","item","saleBtn","selectedAddGoods","purchashPrice","goodsName","name","paymentCode","exchangePointProductBtn","mounted"],"sources":["src/views/sale_management/sale_cmd/List.vue"],"sourcesContent":["<template>\n    <div id=\"sale_cmd\">\n        <div class=\"head\">\n            <i style=\"font-size: 42px\" class=\"iconfont icon-r-home\"> </i>\n            销售主页\n        </div>\n\n        <div class=\"cmd\">\n            <el-col :span=\"12\">\n                <button @click=\"saleBtn\">\n                    <i style=\"font-size: 32px\" class=\"iconfont icon-r-yes\"> </i>\n                    购物结账\n                </button>\n            </el-col>\n            <el-col :span=\"12\">\n                <button @click=\"exchangePointProductBtn\">\n                    <i style=\"font-size: 32px\" class=\"iconfont icon-r-refresh\">\n                    </i>\n                    积分兑换\n                </button>\n            </el-col>\n            <el-col :span=\"12\">\n                <button @click=\"saleRecordsBtn\">\n                    <i style=\"font-size: 32px\" class=\"iconfont icon-r-paper\">\n                    </i>\n                    销售记录\n                </button>\n            </el-col>\n            <el-col :span=\"12\">\n                <button @click=\"exchangePointProductsRecordsBtn\">\n                    <i style=\"font-size: 32px\" class=\"iconfont icon-r-find\">\n                    </i>\n                    兑换记录\n                </button>\n            </el-col>\n        </div>\n        <!--销售-->\n        <el-dialog title=\"销售商品\" :visible.sync=\"newVisable\" width=\"80%\">\n            <el-form\n                :model=\"newForm\"\n                :rules=\"rules\"\n                ref=\"newForm\"\n                label-width=\"100px\"\n                class=\"demo-ruleForm\"\n            >\n                <el-row>\n                    <el-col :span=\"24\">\n                        <el-form-item style=\"width: 60%\" label=\"销售编号：\">\n                            <el-input\n                                readonly\n                                v-model=\"newForm.cn\"\n                                placeholder=\"如：销售编号\"\n                            ></el-input>\n                        </el-form-item>\n                    </el-col>\n                </el-row>\n                <el-row>\n                    <el-col :span=\"12\">\n                        <el-form-item\n                            v-if=\"!newForm.sellTime\"\n                            label=\"支付方式：\"\n                            prop=\"sellway\"\n                        >\n                            <el-radio\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"0\"\n                                >支付宝</el-radio\n                            >\n                            <el-radio\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"1\"\n                                >微信</el-radio\n                            >\n                            <el-radio\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"2\"\n                                >现金</el-radio\n                            >\n                            <el-radio\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"3\"\n                                >银行卡</el-radio\n                            >\n                        </el-form-item>\n                        <el-form-item\n                            v-else\n                            style=\"width: 80%\"\n                            label=\"支付方式：\"\n                            prop=\"sellway\"\n                        >\n                            <el-radio\n                                disabled\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"0\"\n                                >支付宝</el-radio\n                            >\n                            <el-radio\n                                disabled\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"1\"\n                                >微信</el-radio\n                            >\n                            <el-radio\n                                disabled\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"2\"\n                                >现金</el-radio\n                            >\n                            <el-radio\n                                disabled\n                                type=\"radio\"\n                                v-model=\"newForm.sellway\"\n                                label=\"3\"\n                                >银行卡</el-radio\n                            >\n                        </el-form-item>\n                    </el-col>\n                </el-row>\n                <el-row>\n                    <el-col :span=\"12\">\n                        <el-form-item\n                            v-if=\"!newForm.sellTime\"\n                            style=\"width: 60%\"\n                            label=\"顾客类型：\"\n                            prop=\"type\"\n                        >\n                            <el-radio\n                                @change=\"\n                                    () => {\n                                        if (this.newForm.type == '1') {\n                                            this.newForm.sellTotalmoney = (\n                                                this.totalMoney * 0.9\n                                            ).toFixed(2);\n                                        } else {\n                                            this.newForm.sellTotalmoney =\n                                                this.totalMoney.toFixed(2);\n                                        }\n                                    }\n                                \"\n                                type=\"radio\"\n                                v-model=\"newForm.type\"\n                                label=\"1\"\n                                >会员\n                            </el-radio>\n                            <el-radio\n                                @change=\"\n                                    () => {\n                                        if (this.newForm.type == '1') {\n                                            this.newForm.sellTotalmoney = (\n                                                this.totalMoney * 0.9\n                                            ).toFixed(2);\n                                        } else {\n                                            this.newForm.sellTotalmoney =\n                                                this.totalMoney.toFixed(2);\n                                        }\n                                    }\n                                \"\n                                type=\"radio\"\n                                v-model=\"newForm.type\"\n                                label=\"0\"\n                                >非会员\n                            </el-radio>\n                        </el-form-item>\n                        <el-form-item\n                            v-else\n                            style=\"width: 60%\"\n                            label=\"顾客类型：\"\n                            prop=\"type\"\n                        >\n                            <el-radio\n                                disabled\n                                @change=\"\n                                    () => {\n                                        if (this.newForm.type == '1') {\n                                            this.newForm.sellTotalmoney = (\n                                                this.totalMoney * 0.9\n                                            ).toFixed(2);\n                                        } else {\n                                            this.newForm.sellTotalmoney =\n                                                this.totalMoney.toFixed(2);\n                                        }\n                                    }\n                                \"\n                                type=\"radio\"\n                                v-model=\"newForm.type\"\n                                label=\"1\"\n                                >会员\n                            </el-radio>\n                            <el-radio\n                                disabled\n                                @change=\"\n                                    () => {\n                                        if (this.newForm.type == '1') {\n                                            this.newForm.sellTotalmoney = (\n                                                this.totalMoney * 0.9\n                                            ).toFixed(2);\n                                        } else {\n                                            this.newForm.sellTotalmoney =\n                                                this.totalMoney.toFixed(2);\n                                        }\n                                    }\n                                \"\n                                type=\"radio\"\n                                v-model=\"newForm.type\"\n                                label=\"0\"\n                                >非会员\n                            </el-radio>\n                        </el-form-item>\n                    </el-col>\n                    <el-col :span=\"12\" v-if=\"newForm.type == '1'\">\n                        <el-form-item\n                            style=\"width: 60%\"\n                            label=\"会员账号：\"\n                            prop=\"memberPhone\"\n                        >\n                            <el-input\n                                @change=\"\n                                    queryMemberByPhone(newForm.memberPhone)\n                                \"\n                                v-model=\"newForm.memberPhone\"\n                                placeholder=\"如：电话号码\"\n                            ></el-input>\n                        </el-form-item>\n                    </el-col>\n                    <el-col\n                        :span=\"12\"\n                        v-if=\"newForm.type == '1' && newForm.sellTime\"\n                    >\n                        <el-form-item\n                            style=\"width: 60%\"\n                            label=\"会员账号：\"\n                            prop=\"memberPhone\"\n                        >\n                            <el-input\n                                readonly\n                                v-model=\"newForm.memberPhone\"\n                                placeholder=\"如：电话号码\"\n                            ></el-input>\n                        </el-form-item>\n                    </el-col>\n                </el-row>\n                <hr />\n                <el-row>\n                    <el-col :span=\"24\" style=\"text-align: left;\">\n                        <el-button type=\"success\" @click=\"addGoodsBtn\">\n                            <i class=\"iconfont icon-r-add\"> </i>\n                            添加商品</el-button\n                        >\n                    </el-col>\n                    <el-col :span=\"24\">\n                        <el-table\n                            :data=\"newForm.detailSaleRecords\"\n                            style=\"width: 100%;border-top: 1px solid lightgrey;\"\n                            size=\"medium\"\n                        >\n                            <el-table-column prop=\"goodsId\" label=\"商品编号\">\n                            </el-table-column>\n                            <el-table-column prop=\"goodsName\" label=\"商品名\">\n                            </el-table-column>\n                            <el-table-column\n                                prop=\"goodsNum\"\n                                width=\"400px\"\n                                label=\"数量\"\n                            >\n                                <template\n                                    v-if=\"!newForm.sellTime\"\n                                    v-slot=\"scope\"\n                                >\n                                    <el-button\n                                        @click=\"redueGoodsNum(scope.row)\"\n                                        type=\"success\"\n                                        >-</el-button\n                                    >\n                                    <el-input\n                                        readonly\n                                        style=\"width: 100px\"\n                                        type=\"number\"\n                                        min=\"1\"\n                                        v-model=\"scope.row.goodsNum\"\n                                    ></el-input>\n                                    <el-button\n                                        @click=\"addGoodsNum(scope.row)\"\n                                        type=\"success\"\n                                        >+</el-button\n                                    >\n                                </template>\n                                <template v-else v-slot=\"scope\">\n                                    <el-button type=\"success\">+</el-button>\n                                    <el-input\n                                        readonly\n                                        style=\"width: 100px\"\n                                        type=\"number\"\n                                        min=\"1\"\n                                        v-model=\"scope.row.goodsNum\"\n                                    ></el-input>\n                                    <el-button type=\"success\">-</el-button>\n                                </template>\n                            </el-table-column>\n                            <el-table-column prop=\"goodsPrice\" label=\"商品单价\">\n                            </el-table-column>\n                            <el-table-column\n                                v-if=\"!newForm.sellTime\"\n                                label=\"操作\"\n                            >\n                                <template v-slot=\"scope\">\n                                    <el-button\n                                        @click=\"removedetailRecords(scope.row)\"\n                                        type=\"danger\"\n                                        >移除</el-button\n                                    >\n                                </template>\n                            </el-table-column>\n                        </el-table>\n                    </el-col>\n                </el-row>\n                <el-row>\n                    <el-col :span=\"24\">\n                        <el-form-item\n                            v-if=\"!newForm.sellTime\"\n                            style=\"width: 60%\"\n                            label=\"备注：\"\n                        >\n                            <el-input\n                                type=\"textarea\"\n                                v-model=\"newForm.info\"\n                                placeholder=\"如：订单1\"\n                            ></el-input>\n                        </el-form-item>\n                        <el-form-item v-else style=\"width: 60%\" label=\"备注：\">\n                            <el-input\n                                disabled\n                                type=\"textarea\"\n                                v-model=\"newForm.info\"\n                                placeholder=\"如：订单1\"\n                            ></el-input>\n                        </el-form-item>\n                    </el-col>\n                </el-row>\n                <el-row>\n                    <el-col :span=\"24\">\n                        <div v-if=\"newForm.detailSaleRecords.length > 0\">\n                            订单号：{{ newForm.cn }}&nbsp;&nbsp; 商品总数：{{\n                                newForm.sellTotal ? newForm.sellTotal : 0\n                            }}&nbsp;&nbsp; 总共：{{\n                                totalMoney ? totalMoney : 0\n                            }}元&nbsp;&nbsp; 消费：{{\n                                newForm.sellTotalmoney\n                                    ? parseFloat(\n                                          newForm.sellTotalmoney\n                                      ).toFixed(2)\n                                    : 0\n                            }}元&nbsp;&nbsp;\n                            <span v-if=\"newForm.sellway\"\n                                >支付方式：{{\n                                    newForm.sellway == \"0\"\n                                        ? \"支付宝\"\n                                        : newForm.sellway == \"1\"\n                                        ? \"微信\"\n                                        : newForm.sellway == \"2\"\n                                        ? \"现金\"\n                                        : \"银行卡\"\n                                }}&nbsp;&nbsp;</span\n                            >\n                            <span v-if=\"newForm.type == '1'\"\n                                >会员享受9折&nbsp;&nbsp;优惠{{\n                                    totalMoney\n                                        ? parseFloat(\n                                              totalMoney -\n                                                  newForm.sellTotalmoney\n                                          ).toFixed(2)\n                                        : 0\n                                }}元&nbsp;&nbsp;</span\n                            >\n                            <span v-if=\"newForm.sellTime\"\n                                >消费时间：{{ newForm.sellTime }}&nbsp;&nbsp;\n                                操作者编号：{{ newForm.eid }}</span\n                            >\n                        </div>\n                    </el-col>\n                </el-row>\n                <el-row>\n                    <el-col :span=\"24\">\n                        <el-form-item>\n                            <el-button\n                                v-if=\"!newForm.sellTime\"\n                                type=\"success\"\n                                @click=\"\n                                    newForm.sellway == '2' ||\n                                    newForm.sellway == '3'\n                                        ? submitNewForm('newForm')\n                                        : paymentCode(newForm.sellway)\n                                \"\n                            >\n                                支付\n                            </el-button>\n                            <el-button\n                                type=\"info\"\n                                @click=\"closeNewForm('newForm')\"\n                                >关闭</el-button\n                            >\n                        </el-form-item>\n                    </el-col>\n                </el-row>\n            </el-form>\n        </el-dialog>\n        <!--添加商品表单-->\n        <el-dialog title=\"添加商品\" :visible.sync=\"addGoodsVisable\" width=\"50%\">\n            <el-form\n                :model=\"detailSaleRecords\"\n                :rules=\"rules\"\n                ref=\"detailSaleRecords\"\n                label-width=\"100px\"\n                class=\"demo-ruleForm\"\n            >\n                <el-form-item style=\"width: 40%\" label=\"商品：\" prop=\"goodsId\">\n                    <el-select\n                        v-model=\"detailSaleRecords.goodsId\"\n                        placeholder=\"请选择商品\"\n                        @change=\"selectedAddGoods\"\n                        filterable\n                        clearable\n                    >\n                        <el-option\n                            v-for=\"item in options_saleRecordsAddGoods\"\n                            :key=\"item.id\"\n                            :label=\"item.name\"\n                            :value=\"item.id\"\n                        >\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item style=\"width: 40%\" label=\"数量：\">\n                    <el-input\n                        type=\"number\"\n                        @change=\"\n                            () => {\n                                this.$forceUpdate();\n                                if (\n                                    this.goodsNum_max <\n                                    this.detailSaleRecords.goodsNum\n                                ) {\n                                    this.detailSaleRecords.goodsNum =\n                                        this.goodsNum_max;\n                                    return;\n                                }\n                                if (this.detailSaleRecords.goodsNum < 1) {\n                                    this.detailSaleRecords.goodsNum = 1;\n                                    return;\n                                }\n                            }\n                        \"\n                        min=\"1\"\n                        :max=\"goodsNum_max\"\n                        v-model=\"detailSaleRecords.goodsNum\"\n                        :placeholder=\"`如：${goodsNum_max ? goodsNum_max : 0}`\"\n                    ></el-input>\n                </el-form-item>\n                <el-form-item style=\"width: 40%\" label=\"单价：\" prop=\"goodsId\">\n                    <el-input\n                        disabled\n                        v-model=\"detailSaleRecords.goodsPrice\"\n                        placeholder=\"如：1\"\n                    ></el-input>\n                </el-form-item>\n                <el-form-item style=\"width: 40%\">\n                    <el-button\n                        type=\"success\"\n                        @click=\"addDetailSaleRecords\"\n                        plain\n                        >确定</el-button\n                    >\n                    <el-button\n                        type=\"warning\"\n                        @click=\"\n                            () => {\n                                this.addGoodsVisable = false;\n                                this.detailSaleRecords = {};\n                                this.options_saleRecordsAddGoods = [];\n                                this.goodsNum_max = '';\n                            }\n                        \"\n                        plain\n                        >取消\n                    </el-button>\n                </el-form-item>\n            </el-form>\n        </el-dialog>\n        <!--支付二维码-->\n        <el-dialog\n            title=\"扫码支付\"\n            :visible.sync=\"paymentCodeVisable\"\n            width=\"40%\"\n        >\n            <el-form label-width=\"100px\" class=\"demo-ruleForm\">\n                <el-form-item>\n                    <template>\n                        <div class=\"paymentCode\">\n                            <!--支付宝二维码-->\n                            <img\n                                v-if=\"newForm.sellway == '0'\"\n                                src=\"https://zyl-9.oss-cn-chengdu.aliyuncs.com/wolf2w-70/background_url/%E6%94%AF%E4%BB%98%E5%AE%9D.jpg\"\n                                alt=\"支付宝收款二维码\"\n                            />\n                            <!--微信二维码-->\n                            <img\n                                v-if=\"newForm.sellway == '1'\"\n                                src=\"https://zyl-9.oss-cn-chengdu.aliyuncs.com/wolf2w-70/background_url/%E5%BE%AE%E4%BF%A1.jpg\"\n                                alt=\"微信收款二维码\"\n                            />\n                        </div>\n                    </template>\n                </el-form-item>\n\n                <el-form-item>\n                    <el-button\n                        type=\"success\"\n                        @click=\"submitNewForm('newForm')\"\n                        plain\n                        >确定支付</el-button\n                    >\n                    <el-button\n                        type=\"warning\"\n                        @click=\"paymentCodeVisable = false\"\n                        plain\n                        >取消支付\n                    </el-button>\n                </el-form-item>\n            </el-form>\n        </el-dialog>\n\n        <!--积分商品-->\n        <el-dialog\n            title=\"兑换积分商品\"\n            :visible.sync=\"pointProductsVisable\"\n            label-width=\"200\"\n            width=\"40%\"\n        >\n            <el-form\n                :model=\"pointProductsForm\"\n                :rules=\"rules\"\n                ref=\"pointProductsForm\"\n                label-width=\"300px\"\n                class=\"demo-ruleForm\"\n            >\n                <el-form-item v-if=\"confirmVisiable\" style=\"width: 80%\">\n                    <img\n                        width=\"100px\"\n                        :src=\"pointProductsForm.coverUrl\"\n                        alt=\"商品图片\"\n                    />\n                </el-form-item>\n                <el-form-item\n                    v-if=\"!confirmVisiable\"\n                    style=\"width: 80%\"\n                    label=\"会员账号：\"\n                    prop=\"memberId\"\n                >\n                    <el-select\n                        @change=\"queryPointProductByMemberId\"\n                        v-model=\"pointProductsForm.memberId\"\n                        placeholder=\"请选择会员\"\n                        filterable\n                        clearable\n                    >\n                        <el-option\n                            v-for=\"item in options_members\"\n                            :key=\"item.id\"\n                            :label=\"item.name\"\n                            :value=\"item.id\"\n                        >\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item\n                    v-if=\"confirmVisiable\"\n                    style=\"width: 80%\"\n                    label=\"会员账号：\"\n                    prop=\"memberId\"\n                >\n                    <el-select\n                        disabled\n                        @change=\"queryPointProductByMemberId\"\n                        v-model=\"pointProductsForm.memberId\"\n                        placeholder=\"请选择会员\"\n                        filterable\n                        clearable\n                    >\n                        <el-option\n                            v-for=\"item in options_members\"\n                            :key=\"item.id\"\n                            :label=\"item.name\"\n                            :value=\"item.id\"\n                        >\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item\n                    v-if=\"!confirmVisiable\"\n                    style=\"width: 80%\"\n                    label=\"积分商品：\"\n                    prop=\"goodsId\"\n                >\n                    <el-select\n                        @change=\"queryPointProductByGoodsId\"\n                        v-model=\"pointProductsForm.goodsId\"\n                        placeholder=\"请选择积分商品\"\n                        filterable\n                        clearable\n                    >\n                        <el-option\n                            v-for=\"item in options_pointProducts\"\n                            :key=\"item.id\"\n                            :label=\"item.name\"\n                            :value=\"item.id\"\n                        >\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item\n                    v-if=\"confirmVisiable\"\n                    style=\"width: 80%\"\n                    label=\"积分商品：\"\n                    prop=\"goodsId\"\n                >\n                    <el-select\n                        disabled\n                        @change=\"queryPointProductByGoodsId\"\n                        v-model=\"pointProductsForm.goodsId\"\n                        placeholder=\"请选择积分商品\"\n                        filterable\n                        clearable\n                    >\n                        <el-option\n                            v-for=\"item in options_pointProducts\"\n                            :key=\"item.id\"\n                            :label=\"item.name\"\n                            :value=\"item.id\"\n                        >\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item\n                    v-if=\"confirmVisiable\"\n                    style=\"width: 80%\"\n                    label=\"所需积分：\"\n                >\n                    <el-input\n                        readonly\n                        type=\"number\"\n                        v-model=\"pointProductsForm.integral\"\n                        placeholder=\"所需积分\"\n                    />\n                </el-form-item>\n                <el-form-item style=\"width: 80%\">\n                    <el-button\n                        v-if=\"confirmVisiable\"\n                        type=\"primary\"\n                        @click=\"submitPointProductsForm('pointProductsForm')\"\n                        >提交\n                    </el-button>\n                    <el-button\n                        v-if=\"confirmVisiable\"\n                        type=\"info\"\n                        @click=\"closePointProductsForm\"\n                        >关闭</el-button\n                    >\n                    <el-button\n                        type=\"success\"\n                        v-if=\"!confirmVisiable\"\n                        @click=\"confirmPointProducts('pointProductsForm')\"\n                        >确定\n                    </el-button>\n                    <el-button\n                        v-if=\"!confirmVisiable\"\n                        type=\"info\"\n                        @click=\"closeConfirmPointProducts\"\n                        >关闭</el-button\n                    >\n                </el-form-item>\n            </el-form>\n        </el-dialog>\n    </div>\n</template>\n<script>\nimport { popup } from \"@/assets/js/common\";\nimport {\n    getCn,\n    getOptionSaleRecordsGoods,\n    saveSaleRecords,\n} from \"@/api/sale_management/saleRecordsApi\";\nimport { queryGoodsById } from \"@/api/goods_management/goods/goodsApi\";\nimport { queryMemberByPhone } from \"@/api/member_management/member/memberApi\";\nimport {\n    queryMemberByGoodsId,\n    queryOptionsMember,\n    queryOptionsMemberPhone,\n    queryOptionsPointProducts,\n    queryPointProductByGoodsId,\n    queryPointProductBymemberId,\n    saveExchangePointProductRecords,\n} from \"@/api/sale_management/exchange_point_products/exchangePointProductsApi\";\n\nexport default {\n    data() {\n        return {\n            confirmVisiable: false,\n            newVisable: false,\n            addGoodsVisable: false,\n            paymentCodeVisable: false,\n            goodsNum_max: \"\",\n            totalMoney: \"\",\n            options_saleRecordsAddGoods: [],\n            detailSaleRecords: {},\n            newForm: {\n                cn: \"\",\n                sellway: \"1\",\n                info: \"\",\n                sellTotal: \"\",\n                sellTotalmoney: \"\",\n                type: \"0\",\n                detailSaleRecords: [],\n            },\n            pointProductsForm: {\n                memberId: \"\",\n                goodsId: \"\",\n                coverUrl: \"\",\n                integral: \"\",\n            },\n            options_members: [],\n            options_pointProducts: [],\n            pointProductsVisable: false,\n            rules: {\n                sellway: [\n                    {\n                        required: true,\n                        message: \"支付方式未选择\",\n                        trigger: \"blur\",\n                    },\n                ],\n                type: [\n                    {\n                        required: true,\n                        message: \"顾客类型未选择\",\n                        trigger: \"blur\",\n                    },\n                ],\n                memberPhone: [\n                    {\n                        required: true,\n                        message: \"会员电话号码未填写\",\n                        trigger: \"blur\",\n                    },\n                ],\n                goodsId: [\n                    {\n                        required: true,\n                        message: \"商品不能为空\",\n                        trigger: \"blur\",\n                    },\n                ],\n                memberId: [\n                    {\n                        required: true,\n                        message: \"会员编号不能为空\",\n                        trigger: \"blur\",\n                    },\n                ],\n            },\n        };\n    },\n    methods: {\n        confirmPointProducts(formName) {\n            this.$refs[formName].validate((valid) => {\n                if (valid) {\n                    queryPointProductByGoodsId({\n                        goodsId: this.pointProductsForm.goodsId,\n                    }).then((res) => {\n                        res = res.data;\n                        if (res.code == 200) {\n                            if (!res.data) {\n                                this.pointProductsForm = {\n                                    memberId: this.pointProductsForm.memberId,\n                                    goodsId: this.pointProductsForm.goodsId,\n                                    coverUrl: \"\",\n                                    integral: \"\",\n                                };\n                                return;\n                            }\n                            this.pointProductsForm.integral = res.data.integral;\n                            this.pointProductsForm.coverUrl = res.data.coverUrl;\n                        } else {\n                            popup(res.msg, \"error\");\n                        }\n                    });\n                    this.confirmVisiable = true;\n                }\n            });\n        },\n        closeConfirmPointProducts() {\n            this.confirmVisiable = false;\n            this.pointProductsVisable = false;\n            this.pointProductsForm = {\n                memberId: \"\",\n                goodsId: \"\",\n                coverUrl: \"\",\n                integral: \"\",\n            };\n        },\n        queryPointProductByMemberId() {\n            queryPointProductBymemberId({\n                memberId: this.pointProductsForm.memberId,\n            }).then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.options_pointProducts = res.data;\n                    if (!this.options_pointProducts.length) {\n                        popup(\"该会员积分数无法兑换任何商品\", \"warning\");\n                        this.pointProductsForm.goodsId = \"\";\n                        return;\n                    }\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        queryPointProductByGoodsId() {\n            queryMemberByGoodsId({\n                goodsId: this.pointProductsForm.goodsId,\n            }).then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.options_members = res.data;\n                    if (!this.options_members.length) {\n                        popup(\"该商品没有会员符合条件进行兑换\", \"warning\");\n                        this.pointProductsForm.memberId = \"\";\n                        return;\n                    }\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        queryOptionsPointProducts() {\n            queryOptionsPointProducts().then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.options_pointProducts = res.data;\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        queryOptionsMember() {\n            queryOptionsMember().then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.options_members = res.data;\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        submitPointProductsForm(formName) {\n            this.$refs[formName].validate((valid) => {\n                if (valid) {\n                    saveExchangePointProductRecords(\n                        this.pointProductsForm\n                    ).then((res) => {\n                        res = res.data;\n                        if (res.code == 200) {\n                            popup(\"兑换成功\");\n                            this.pointProductsForm = {};\n                            this.pointProductsVisable = false;\n                        } else {\n                            popup(res.msg, \"error\");\n                        }\n                    });\n                }\n            });\n        },\n        closePointProductsForm() {\n            this.confirmVisiable = false;\n        },\n        moreFuns() {\n            popup(\"正在研发...\", \"warning\");\n        },\n        queryMemberByPhone(phone) {\n            queryMemberByPhone({ phone: phone }).then((res) => {\n                res = res.data;\n                if (res.code != 200) {\n                    popup(res.msg, \"error\");\n                    this.newForm.memberPhone = \"\";\n                }\n            });\n        },\n        saleRecordsBtn() {\n            this.$router.push(\"/sale_management/sale_records/list\");\n        },\n        exchangePointProductsRecordsBtn() {\n            this.$router.push(\n                \"/sale_management/exchange_point_products_records/list\"\n            );\n        },\n        submitNewForm(formName) {\n            this.$refs[formName].validate((valid) => {\n                if (valid) {\n                    if (this.newForm.detailSaleRecords.length <= 0) {\n                        popup(\"还没选择出售的商品\", \"error\");\n                        return;\n                    }\n                    saveSaleRecords(this.newForm).then((res) => {\n                        res = res.data;\n                        if (res.code == 200) {\n                            this.newForm = { ...res.data };\n                            console.log(this.newForm);\n                            popup(\"支付成功\");\n                            this.paymentCodeVisable = false;\n                        } else {\n                            popup(\"系统正忙,支付失败\", \"error\");\n                        }\n                    });\n                }\n            });\n        },\n        closeNewForm(formName) {\n            this.$refs[formName].resetFields();\n            (this.newForm = {\n                cn: \"\",\n                sellway: \"1\",\n                info: \"\",\n                sellTotal: \"\",\n                sellTotalmoney: \"\",\n                type: \"0\",\n                detailSaleRecords: [],\n            }),\n                (this.newVisable = false);\n        },\n        removedetailRecords(row) {\n            this.$confirm(\"确定删除这条记录？\", \"警示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            })\n                .then(() => {\n                    this.newForm.sellTotal =\n                        parseInt(this.newForm.sellTotal) - row.goodsNum;\n                    this.totalMoney = (\n                        parseFloat(this.totalMoney) -\n                        parseFloat(\n                            parseInt(row.goodsNum) * parseFloat(row.goodsPrice)\n                        )\n                    ).toFixed(2);\n                    if (this.newForm.type == \"1\") {\n                        this.newForm.sellTotalmoney =\n                            parseFloat(this.totalMoney) * (0.9).toFixed(2);\n                    } else {\n                        this.newForm.sellTotalmoney = parseFloat(\n                            this.totalMoney\n                        ).toFixed(2);\n                    }\n                    for (var i in this.newForm.detailSaleRecords) {\n                        if (\n                            this.newForm.detailSaleRecords[i].goodsId ==\n                            row.goodsId\n                        ) {\n                            this.newForm.detailSaleRecords.splice(i, 1);\n                            return;\n                        }\n                    }\n                })\n                .catch(() => {\n                    this.$message({\n                        type: \"info\",\n                        message: \"已取消操作\",\n                    });\n                });\n        },\n        addGoodsNum(row) {\n            queryGoodsById({ id: row.goodsId }).then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    if (row.goodsNum >= res.data.residueNum) {\n                        popup(\n                            \"货架商品数量没这么多，请联系仓库管理者\",\n                            \"warning\"\n                        );\n                        return;\n                    } else {\n                        row.goodsNum = parseInt(row.goodsNum) + 1;\n                        this.newForm.sellTotal =\n                            parseInt(this.newForm.sellTotal) + 1;\n\n                        this.totalMoney = (\n                            parseFloat(this.totalMoney) +\n                            parseFloat(row.goodsPrice)\n                        ).toFixed(2);\n                        if (this.newForm.type == \"1\") {\n                            this.newForm.sellTotalmoney =\n                                parseFloat(this.totalMoney) * (0.9).toFixed(2);\n                        } else {\n                            this.newForm.sellTotalmoney = parseFloat(\n                                this.totalMoney\n                            ).toFixed(2);\n                        }\n                    }\n                } else {\n                    popup(res.msg, \"error\");\n                    return;\n                }\n            });\n        },\n        redueGoodsNum(row) {\n            if (parseInt(row.goodsNum) == 1) {\n                popup(\"已是最小数量\", \"error\");\n                return;\n            }\n            row.goodsNum = parseInt(row.goodsNum) - 1;\n            this.newForm.sellTotal = parseInt(this.newForm.sellTotal) - 1;\n            this.totalMoney = (\n                parseFloat(this.totalMoney) - parseFloat(row.goodsPrice)\n            ).toFixed(2);\n            if (this.newForm.type == \"1\") {\n                this.newForm.sellTotalmoney =\n                    parseFloat(this.totalMoney) * (0.9).toFixed(2);\n            } else {\n                this.newForm.sellTotalmoney = parseFloat(\n                    this.totalMoney\n                ).toFixed(2);\n            }\n        },\n        initOptionSaleRecordsAddGoodsAll() {\n            getOptionSaleRecordsGoods().then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.options_saleRecordsAddGoods = res.data;\n                    if (this.options_saleRecordsAddGoods.length > 0) {\n                        this.addGoodsVisable = true;\n                    } else {\n                        popup(\"目前没有可售卖的商品\", \"warning\");\n                    }\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        addGoodsBtn() {\n            this.detailSaleRecords = {};\n            this.goodsNum_max = \"\";\n            this.initOptionSaleRecordsAddGoodsAll();\n        },\n        addDetailSaleRecords() {\n            if (!this.detailSaleRecords.goodsNum) {\n                popup(\"数量不能为空\", \"warning\");\n                return;\n            }\n            this.newForm.sellTotal =\n                Number.parseInt(\n                    this.newForm.sellTotal ? this.newForm.sellTotal : 0\n                ) + Number.parseInt(this.detailSaleRecords.goodsNum);\n            this.totalMoney =\n                (this.totalMoney ? parseFloat(this.totalMoney) : 0) +\n                parseInt(this.detailSaleRecords.goodsNum) *\n                    parseFloat(this.detailSaleRecords.goodsPrice).toFixed(2);\n            if (this.totalMoney) {\n                if (this.newForm.type == \"1\") {\n                    this.newForm.sellTotalmoney = this.totalMoney * 0.9;\n                } else {\n                    this.newForm.sellTotalmoney = this.totalMoney;\n                }\n            }\n            if (this.newForm.detailSaleRecords.length == 0) {\n                this.newForm.detailSaleRecords.unshift(this.detailSaleRecords);\n            } else {\n                for (var item of this.newForm.detailSaleRecords) {\n                    if (item.goodsId == this.detailSaleRecords.goodsId) {\n                        item.goodsNum =\n                            Number.parseInt(item.goodsNum) +\n                            Number.parseInt(this.detailSaleRecords.goodsNum);\n                        this.addGoodsVisable = false;\n                        return;\n                    }\n                }\n                this.newForm.detailSaleRecords.unshift(this.detailSaleRecords);\n            }\n            this.addGoodsVisable = false;\n        },\n        saleBtn() {\n            getCn().then((res) => {\n                res = res.data;\n                if (res.code == 200) {\n                    this.newForm.cn = res.data;\n                    this.newVisable = true;\n                } else {\n                    popup(res.msg, \"error\");\n                }\n            });\n        },\n        selectedAddGoods() {\n            queryGoodsById({ id: this.detailSaleRecords.goodsId }).then(\n                (res) => {\n                    res = res.data;\n                    if (res.code == 200) {\n                        this.detailSaleRecords.goodsPrice =\n                            res.data.purchashPrice;\n                        this.detailSaleRecords.goodsName = res.data.name;\n                        this.goodsNum_max = res.data.residueNum;\n                    }\n                }\n            );\n        },\n        paymentCode(sellway) {\n            if (this.newForm.detailSaleRecords.length <= 0) {\n                popup(\"还没选择出售的商品\", \"error\");\n                return;\n            }\n            if (sellway != \"2\") {\n                this.paymentCodeVisable = true;\n            }\n        },\n        exchangePointProductBtn() {\n            this.queryOptionsMember();\n            this.queryOptionsPointProducts();\n            this.pointProductsVisable = true;\n        },\n    },\n    mounted() {},\n};\n</script>\n\n\n<style>\n#sale_cmd {\n    top: 0;\n    left: 0;\n    width: 100%;\n    overflow-y: auto;\n    height: 90vh;\n    background: url(\"../../../assets/img/01.jpg\") center top / cover no-repeat;\n    margin: 0 auto;\n}\n\n#sale_cmd .head {\n    height: 100px;\n    font-size: 42px;\n    font-weight: bolder;\n    margin-top: 50px;\n    color: black;\n}\n\n#sale_cmd .cmd {\n    width: 80%;\n    margin: 0 auto;\n}\n\n#sale_cmd .cmd button {\n    width: 85%;\n    height: 100px;\n    margin: 2%;\n    border-radius: 3px;\n    font-size: 32px;\n    cursor: pointer;\n    font-weight: 600;\n}\n\n#sale_cmd .cmd button:hover {\n    background-color: #6495ed;\n}\n\n#sale_cmd .paymentCode {\n    height: 182px;\n    width: 182px;\n    margin: 0 auto;\n    background-color: #efefef;\n}\n\n#sale_cmd .paymentCode img {\n    height: 182px;\n    width: 182px;\n    text-align: center;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}